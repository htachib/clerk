module UnfiEastDeductionInvoice
  class Base
    include GlobalSanitizers

    LOOKUP_TABLE = [{
      "Invoice # Format"=>/\w+AHOLD/,
      "Invoice # Condition"=>/AHOLD$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Ahold / Stop & Shop",
      "Customer Detailed Name"=>"Ahold / Stop & Shop",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+BIGY/,
      "Invoice # Condition"=>/BIGY$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Big Y",
      "Customer Detailed Name"=>"Big Y",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+DIBRGS/,
      "Invoice # Condition"=>/DIBRGS$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Dierberg's",
      "Customer Detailed Name"=>"Dierberg's",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+EOM/,
      "Invoice # Condition"=>/EOM$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Earth Origins",
      "Customer Detailed Name"=>"Earth Origins",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+EFA/,
      "Invoice # Condition"=>/EFA$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Earth Fare",
      "Customer Detailed Name"=>"Earth Fare",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+GEAGLE/,
      "Invoice # Condition"=>/GEAGLE$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRGE(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRGE/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Giant Eagle",
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRGE(\d{3}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRGE/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Giant Eagle",
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+GEAGLE/,
      "Invoice # Condition"=>/GEAGLE$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRGE(\d{2}\d{2})\w+A/,
      "Invoice # Condition"=>/^FSRGE/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Giant Eagle",
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRGE(\d{3}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRGE/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Giant Eagle",
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+GEAGLE/,
      "Invoice # Condition"=>/GEAGLE$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/NSOKOW\w+HCM/,
      "Invoice # Condition"=>/^NSOKOW/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>"Free Fill",
      "Deduction Description"=>"New Store Opening - Kowalski",
      "Customer Chain ID"=>"Kowalski",
      "Customer Detailed Name"=>"Kowalski",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+PUBLIX/,
      "Invoice # Condition"=>/PUBLIX$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Publix",
      "Customer Detailed Name"=>"Publix",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+TFM/,
      "Invoice # Condition"=>/TFM$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRTFM(\d{2}\d{2})\w+PB/,
      "Invoice # Condition"=>/^FSRTFM/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - The Fresh Market",
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"The Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRTFMGR(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRTFMGR/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - The Fresh Market",
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"The Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+TFM/,
      "Invoice # Condition"=>/TFM$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRTFMGR(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRTFMGR/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - The Fresh Market",
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"The Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRTFMGR(\d{3}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRTFMGR/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - The Fresh Market",
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"The Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+TFM/,
      "Invoice # Condition"=>/TFM$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"The Fresh Market",
      "Customer Detailed Name"=>"Fresh Market",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERDC(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERDC/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Ad Fee",
      "Deduction Description"=>"Advertising - Quarterly Ad Billings",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/EROSF(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^EROSF/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Shortage",
      "Deduction Description"=>"Over Shipment Fee",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERNACVTN(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERNACVTN/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Slotting",
      "Deduction Description"=>"New Item Activation Fee",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRGE(\d{3}\d{2})\w+PB/,
      "Invoice # Condition"=>/^FSRGE/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Giant Eagle",
      "Customer Chain ID"=>"Giant Eagle",
      "Customer Detailed Name"=>"Giant Eagle",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERVELCTY(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERVELCTY/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Sales Report",
      "Deduction Description"=>"Velocity Report",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERDC(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERDC/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Ad Fee",
      "Deduction Description"=>"Advertising - Quarterly Ad Billings",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/CONACT(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^CONACT/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Slotting",
      "Deduction Description"=>"New Item Activation Fee",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERNACVTN(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERNACVTN/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Slotting",
      "Deduction Description"=>"New Item Activation Fee",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/EROSF\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^EROSF/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Shortage",
      "Deduction Description"=>"Over Shipment Fee",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/ERVELCTY(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^ERVELCTY/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Sales Report",
      "Deduction Description"=>"Velocity Report",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/WRVELCTY(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^WRVELCTY/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Sales Report",
      "Deduction Description"=>"Velocity Report",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/SBM(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^SBM/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Trade Shows",
      "Deduction Description"=>"Strategic Brands Meeting",
      "Customer Chain ID"=>"UNFI East",
      "Customer Detailed Name"=>"UNFI East",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/URMTO\w+HCM/,
      "Invoice # Condition"=>/^URMTO/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>"MCB",
      "Deduction Description"=>"URM Turnovers",
      "Customer Chain ID"=>"URM",
      "Customer Detailed Name"=>"URM",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/NSOWKF\w+HCM/,
      "Invoice # Condition"=>/^NSOWKF/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>"Free Fill",
      "Deduction Description"=>"New Store Opening - Kowalski",
      "Customer Chain ID"=>"Wakefern",
      "Customer Detailed Name"=>"Wakefern",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRWGM(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRWGM/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Wegmans",
      "Customer Chain ID"=>"Wegman's",
      "Customer Detailed Name"=>"Wegman's",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/FSRWGM(\d{3}\d{2})\w+/,
      "Invoice # Condition"=>/^FSRWGM/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Wegmans",
      "Customer Chain ID"=>"Wegman's",
      "Customer Detailed Name"=>"Wegman's",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+WEGMNS/,
      "Invoice # Condition"=>/WEGMNS$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Wegman's",
      "Customer Detailed Name"=>"Wegman's",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+WINDIX/,
      "Invoice # Condition"=>/WINDIX$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>nil,
      "Customer Chain ID"=>"Winn Dixie",
      "Customer Detailed Name"=>"Winn Dixie",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/\w+WINDIXPB/,
      "Invoice # Condition"=>/WINDIXPB$/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>nil,
      "Promo End Date"=>nil,
      "Deduction Type"=>nil,
      "Deduction Description"=>"Payback of prior incorrect deduction",
      "Customer Chain ID"=>"Winn Dixie",
      "Customer Detailed Name"=>"Winn Dixie",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil},
     {"Invoice # Format"=>/KGFRSR(\d{2}\d{2})\w+/,
      "Invoice # Condition"=>/^KFGRSR/,
      "Customer"=>nil,
      "Parser"=>"UNFI East Deduction Invoice",
      "File Name"=>nil,
      "Invoice Number"=>nil,
      "Deduction Post Date"=>nil,
      "Promo Start Date"=>"{{start of month}}",
      "Promo End Date"=>"{{end of month}}",
      "Deduction Type"=>"Merchandising",
      "Deduction Description"=>"Fair Share - Kroger",
      "Customer Chain ID"=>"Kroger",
      "Customer Detailed Name"=>"Kroger",
      "Chargeback Amount"=>nil,
      "Shipped"=>nil,
      "Variable Rate per Unit"=>nil
    }]

    def lookup_condition(invoice_number)
      LOOKUP_TABLE.each_with_index do |lookup, idx|
        format = lookup['Invoice # Format']
        condition = lookup['Invoice # Condition']
        date_string = invoice_number.try(:scan,format).try(:flatten).try(:first)
        if date_string && invoice_number.match?(condition)
          return idx, date_string
        end
      end

    end

    def promo_dates
      promo_dates = date_string_to_promo_dates(date_string)
    end

    def lookup_output(invoice_number)
      table_id, date_string = lookup_condition(invoice_number)
      dates = date_string_to_promo_dates(date_string)

      lookup = LOOKUP_TABLE[table_id]

      {
        "Customer"=>lookup['Customer'],
        "Promo Start Date"=>dates['start_date'],
        "Promo End Date"=>dates['end_date'],
        "Deduction Type"=>lookup['Deduction Type'],
        "Deduction Description"=>lookup['Deduction Description'],
        "Customer Chain ID"=>lookup['Customer Chain ID'],
        "Customer Detailed Name"=>lookup['Customer Detailed Name'],
        "Chargeback Amount"=>lookup['Chargeback Amount'],
        "Shipped"=>lookup['Shipped'],
        "Variable Rate per Unit"=>lookup['Variable Rate per Unit']
      }
    end
  end
end
